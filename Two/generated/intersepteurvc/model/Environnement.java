//
// THIS FILE IS AUTOMATICALLY GENERATED!!
//
// Generated at 2021-12-01 by the VDM++ to JAVA Code Generator
// (v9.0.7 - Sat 09-Jun-2018 10:11:21 +0900)
//
// ***** VDMTOOLS START Name=HeaderComment KEEP=NO
// ***** VDMTOOLS END Name=HeaderComment

// This file was genereted from "C:\\Users\\nmari\\GL_PROJET_M1_S7\\Two\\Environnement.vdmpp".

// ***** VDMTOOLS START Name=package KEEP=NO
package intersepteurvc.model;
// ***** VDMTOOLS END Name=package

// ***** VDMTOOLS START Name=imports KEEP=NO
import java.util.Map;
import java.util.List;
import java.util.HashMap;
import java.util.ArrayList;
import jp.vdmtools.VDM.UTIL;
import jp.vdmtools.VDM.Tuple;
import jp.vdmtools.VDM.CGException;
// ***** VDMTOOLS END Name=imports



public class Environnement {

// ***** VDMTOOLS START Name=periode KEEP=NO
  protected Number periode = null;
// ***** VDMTOOLS END Name=periode

// ***** VDMTOOLS START Name=estPeriodique KEEP=NO
  protected Boolean estPeriodique = null;
// ***** VDMTOOLS END Name=estPeriodique

// ***** VDMTOOLS START Name=io KEEP=NO
  private IO io = null;
// ***** VDMTOOLS END Name=io

// ***** VDMTOOLS START Name=datas KEEP=NO
  private List datas = null;
// ***** VDMTOOLS END Name=datas

// ***** VDMTOOLS START Name=DureeSimulation KEEP=NO
  private Number DureeSimulation = null;
// ***** VDMTOOLS END Name=DureeSimulation

// ***** VDMTOOLS START Name=fini KEEP=NO
  private Boolean fini = null;
// ***** VDMTOOLS END Name=fini

// ***** VDMTOOLS START Name=vdm_init_Environnement KEEP=NO
  private void vdm_init_Environnement () {
    try {
      periode = Long.valueOf(1);
      estPeriodique = Boolean.TRUE;
      io = new IO();
      datas = new ArrayList();
      DureeSimulation = Long.valueOf(0);
      fini = Boolean.FALSE;
    }
    catch (Exception e) {
      e.printStackTrace(System.out);
      System.out.println(e.getMessage());
    }
  }
// ***** VDMTOOLS END Name=vdm_init_Environnement

// ***** VDMTOOLS START Name=Environnement KEEP=NO
  public Environnement () throws CGException {
    this.vdm_init_Environnement();
  }
// ***** VDMTOOLS END Name=Environnement

// ***** VDMTOOLS START Name=Environnement#3|String|Number|Boolean KEEP=NO
  public Environnement (final String fichierData, final Number p, final Boolean estP) throws CGException {
    vdm_init_Environnement();
    periode = UTIL.NumberToLong(UTIL.clone(p));
    estPeriodique = (Boolean)UTIL.clone(estP);
    boolean succ_6 = false;
    Number t = null;
    List input = null;
    final Tuple tmpVar_9 = io.freadval(fichierData);
    final Tuple tmpVar_10 = (Tuple)tmpVar_9.GetField(2);
    if (succ_6 = ((tmpVar_10 instanceof Tuple) && (2 == ((Tuple)tmpVar_10).Length()))) {
      t = UTIL.NumberToLong(((Tuple)tmpVar_10).GetField(1));
      input = UTIL.ConvertToList(((Tuple)tmpVar_10).GetField(2));
    }
    if (!succ_6) {
      UTIL.RunTime("Pattern match did not succeed in value definition");
    }
    datas = UTIL.ConvertToList(UTIL.clone(input));
    DureeSimulation = UTIL.NumberToLong(UTIL.clone(t));
  }
// ***** VDMTOOLS END Name=Environnement#3|String|Number|Boolean

// ***** VDMTOOLS START Name=estFini KEEP=NO
  public void estFini () throws CGException {}
// ***** VDMTOOLS END Name=estFini

// ***** VDMTOOLS START Name=Finir KEEP=NO
  public void Finir () throws CGException {
    fini = Boolean.TRUE;
  }
// ***** VDMTOOLS END Name=Finir

// ***** VDMTOOLS START Name=stimuli KEEP=NO
  private void stimuli () throws CGException {
    if (datas.size() > 0) {
      Number dateActuelle = Animation.horloge.GetTime();
      {
        final Tuple tmpVar_9 = (Tuple)datas.get(0);
        final Number date = UTIL.NumberToLong(tmpVar_9.GetField(1));
        final Boolean Ndetect = (Boolean)tmpVar_9.GetField(2);
        final Object Me = tmpVar_9.GetField(3);
        final Number id = UTIL.NumberToLong(tmpVar_9.GetField(4));
        final Number dis = UTIL.NumberToLong(tmpVar_9.GetField(5));
        final Number lon = UTIL.NumberToLong(tmpVar_9.GetField(6));
        final Number lat = UTIL.NumberToLong(tmpVar_9.GetField(7));
        if (date.longValue() <= dateActuelle.longValue()) {
          Map par_14 = new HashMap();
          par_14.put(id, dis);
          SystemeRTP.leContexte.Setdis(par_14);
          Map par_18 = new HashMap();
          par_18.put(id, lon);
          SystemeRTP.leContexte.Setlon(par_18);
          Map par_22 = new HashMap();
          par_22.put(id, lat);
          SystemeRTP.leContexte.Setlat(par_22);
          SystemeRTP.leContexte.SetNouvelleMenace(Ndetect);
          SystemeRTP.leContexte.SetTypeMenace(Me);
          datas = new ArrayList(datas.subList(1, datas.size()));
          return;
        }
      }
    }
    else {
      fini = Boolean.TRUE;
      return;
    }
  }
// ***** VDMTOOLS END Name=stimuli

// ***** VDMTOOLS START Name=Action KEEP=NO
  protected void Action () throws CGException {
    if (Animation.horloge.GetTime().longValue() < DureeSimulation.longValue()) {
      stimuli();
    }
    else {
      fini = Boolean.TRUE;
    }
  }
// ***** VDMTOOLS END Name=Action

}

